# Usar imagem base com JDK 21 para construir o projeto
FROM eclipse-temurin:21-jdk as build

WORKDIR /app

# Copia arquivos do projeto para dentro do container
COPY . .

# Build usando Maven Wrapper, pulando testes para acelerar
RUN ./mvnw clean package -DskipTests

# Imagem final mínima para rodar a aplicação
FROM eclipse-temurin:21-jre

WORKDIR /app

# Copiar o JAR gerado do estágio de build
COPY target/sis-acad-backend-1.0.0-SNAPSHOT.jar app.jar

EXPOSE 8080

# Comando para rodar a aplicação Quarkus
CMD ["java", "-jar", "app.jar"]
